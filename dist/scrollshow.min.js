!function(e){e.fn.scrollshow=function(n){var t={id:"scrollshow",scrollRange:2e3,keepActive:!0,textEllipsis:"...",intro:!0,navigation:!1,progressBar:!0,overlay:!0,onItemChange:function(e){},onItemEnd:function(e){},onFirstItem:function(e){},onLastItem:function(e){},onScrollEnd:function(e){}};if("object"==typeof n){Object.getOwnPropertyNames(n).forEach(function(e){t.hasOwnProperty(e)&&(t[e]=n[e])})}var r=e("body"),i=window.innerWidth,a=window.innerHeight,o=e("#"+t.id);t.overlay&&o.append('<div class="overlay"></div>');var s=0,c=0,l=o.children(".item").length,d=t.scrollRange;r.height(l*d+a);var v=-1;if(t.navigation){o.append('<nav class="navigation"></nav>');for(var p=o.children(".navigation"),f=0;f<l;f++)p.append('<a href="#'+f.toString()+'"></a>'),0==f&&p.append('<span class="progress"></span>');var h=p.children("a:first-child"),g=(h.outerWidth(),h.outerHeight()),m=parseFloat(h.css("margin-bottom")),u=l*(g+m);p.find("a").on("click",function(n){n.preventDefault();var t=e(this).attr("href").replace("#",""),r=(t=parseInt(t))*d;e(document).scrollTop(r)})}var w=function(n){"string"==typeof n&&o.find(n).each(function(){var n=e(this).children().eq(0),r=n.text()+" "+t.textEllipsis,i="",a=1e3;i+='<span class="word">';for(var o=0;o<r.length;o++)" "==r[o]?(i+="</span>",i+='<span class="separator">'+r[o]+"</span>",i+='<span class="word">'):i+='<span class="letter" style="z-index:'+a+';">'+r[o]+"</span>",a--;i+="</span>",n.html(i)})};w(".item");t.intro&&(o.append('<div class="intro"><header><h1>'+document.title+'</h1><p class="description">'+e('head meta[name="description"]').attr("content")+"</p></header></div>"),w(".intro header"),setTimeout(function(){-1==v&&o.children(".intro").addClass("active")},16)),t.progressBar&&o.append('<div class="progress-bar"></div>'),e(document).on("scroll",function(n){!function(){(c=e(window).scrollTop())>=l*d&&(c=l*d-1,e.Event("scrollEnd"),o.trigger({type:"scrollEnd"}));s=parseInt(c/d);var n=c-d*s,r=o.children(".item:eq("+s+")"),a=o.children(".item:not(:eq("+s+"))"),f=o.find(".item:eq("+s+") .letter").length,h=parseInt(d/f),w=parseInt(n/h);if(w!=v){if(v=w,r.hasClass("active")||(e.Event("itemChange"),e.Event("lastItem"),e.Event("firstItem"),o.trigger({type:"itemChange",targetIndex:s}),0==s&&o.trigger({type:"firstItem"}),s==l-1&&o.trigger({type:"lastItem"})),r.addClass("active"),r.find(".letter:eq("+w+")").addClass("active current"),t.keepActive){for(I=0;I<w;I++)r.find(".letter:eq("+I+")").addClass("active").removeClass("current");for(var I=w+1;I<f;I++)r.find(".letter:eq("+I+")").removeClass("active current")}else r.find(".letter:not(:eq("+w+"))").removeClass("active current");if(w==f-1&&(e.Event("itemEnd"),o.trigger({type:"itemEnd",index:s})),a.removeClass("active"),t.navigation){for(var E=0;E<l;E++)E<=s?p.find('a[href="#'+E.toString()+'"]').addClass("active"):p.find('a[href="#'+E.toString()+'"]').removeClass("active");var C=c/(l*d)*u;s+1==l&&(C=u-m-g),p.children(".progress").height(C)}if(t.intro&&c>0&&o.children(".intro").removeClass("active"),t.progressBar){var y=c/(l*d)*i;o.children(".progress-bar").css("width",y)}v=w}}()}),e(window).on("resize",function(e){i=window.innerWidth,a=window.innerHeight,r.height(l*d+window.innerHeight)}),o.on("itemChange",function(e){var n=e.targetIndex;t.onItemChange(n)}),o.on("firstItem",function(e){t.onFirstItem(e)}),o.on("lastItem",function(e){t.onLastItem(e)}),o.on("itemEnd",function(e){var n=e.index;t.onItemEnd(n)}),o.on("scrollEnd",function(e){t.onScrollEnd(e)})}}(jQuery);