<!DOCTYPE html>
<html lang="{{ page.lang | default: site.lang | default: "en" }}">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>{% if page.title %}{{ page.title }} | {% endif %}{{ site.title }}</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        {% assign pagecontent_description = page.content | markdownify | replace: '.', '. ' | replace: '</h2>', ': ' | replace: '</h3>', ': ' | replace: '</h4>', ': ' | strip_html | strip_newlines | replace: '  ', ' ' | truncate: 160 %}
        <meta name="description" content="{% if page.description %}{{ page.description }}{% else %}{% if pagecontent_description.size > 10 %}{{ pagecontent_description }}{% else %}{{ site.description }}{% endif %}{% endif %} ">
        <link rel="stylesheet" href="{{ site.url }}{{ site.baseurl }}{{ site.assets_dir }}/css/normalize.css">
        <!-- Scrollio required stylesheet -->
        <link href="{{ site.url }}{{ site.baseurl }}{{ site.assets_dir }}/css/full.css" rel="stylesheet">
        <!-- demo purpose only -->
        <style>
            #scrollio>.item .outro {
                transition: all 500ms;
                max-height: 0px;
                overflow: hidden;
            }
            #scrollio>.item .outro.active {
                max-height: 200px;
            }
        </style>
    </head>
    <body>
        <div id="scrollio">
            {{ content }}
        </div>
        <script type="text/javascript" src="{{ site.url }}{{ site.baseurl }}{{ site.assets_dir }}/js/jquery/jquery-3.4.0.min.js"></script>

        <script type="text/javascript" src="{{ site.url }}{{ site.baseurl }}{{ site.assets_dir }}/js/scrollio/scrollio.js"></script>
        <script type="text/javascript" src="{{ site.url }}{{ site.baseurl }}{{ site.assets_dir }}/js/scrollio/plugins/scrollio.plugin.dynamic.background.js"></script>
        <!-- <script type="text/javascript" src="{{ site.url }}{{ site.baseurl }}{{ site.assets_dir }}/js/scrollio/plugins/scrollio.plugin.fullscreen.js"></script>
        <script type="text/javascript" src="{{ site.url }}{{ site.baseurl }}{{ site.assets_dir }}/js/scrollio/plugins/scrollio.plugin.links.js"></script> -->
        <script type="text/javascript">
            document.addEventListener("DOMContentLoaded", function(event) {
                //console.log("DOM fully loaded and parsed");

                var fullUrl = window.location.href;
                hash = fullUrl.split('?');
                var stringifiedSentObject = atob(hash[1]);
                var sentObject = JSON.parse(stringifiedSentObject);
                var wrapper = document.getElementById('scrollio');
                //console.log(sentObject);
                sentObject.content.forEach(function(data) {
                    // console.log('item text:'+data.text);
                    // console.log('item options:'+data.options);
                    jQuery('#scrollio').append(
                        '<div class="item">'+
                            '<p class="scrolltrack">'+data.text+'</p>'+
                        '</div>'
                    );
                });
                window.scrollioAPI.dynamicBackground.jQ_items = jQuery('#scrollio>.item');
                // wrapper.innerHTML = sentObject.content;
                jQuery.fn.scrollio(sentObject.options);
            });
        </script>

    </body>
</html>
