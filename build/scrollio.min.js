!function(e){e.fn.scrollio=function(t){var n={id:"scrollio",scrollRange:2e3,keepActive:!0,textEllipsis:"...",fontSize:6,intro:!1,introTitle:"",introDescription:"",progressBar:!0,overlay:!0,onItemChange:function(e){},onLetterChange:function(e){},onScroll:function(e){},onItemEnd:function(e){},onFirstItem:function(e){},onLastItem:function(e){},onScrollEnd:function(e){}};if("string"==typeof t){if(0==t.indexOf("get:")){var i=t.replace("get:","");return"all"==i?n:void 0!==n[i]?n[i]:(console.log("not a valid scrollio parameter"),!1)}return console.log("not a valid request"),!1}var o=e("#"+n.id);if(o.hasClass("initialized"))console.log("Scrollio already initialized");else{var r=e("body"),s=window.innerWidth,a=window.innerHeight;if("object"==typeof t){Object.getOwnPropertyNames(t).forEach(function(e){n.hasOwnProperty(e)&&(n[e]=t[e])})}n.overlay&&o.append('<div class="overlay"></div>');var l=0,c=0,d=0,f=o.children(".item").length,p=n.scrollRange,v=c/(f*p),g=v*s,h=0,m=0;r.height(f*p+a);var u=-1,C=!0,w=e('head meta[name="description"]').attr("content"),E=document.title,y=function(t){"string"==typeof t&&o.find(t).each(function(){var t=e(this).children().eq(0),i=t.text(),o="",r=1e3;o+='<span class="word">';for(l=0;l<i.length;l++)" "==i[l]?(o+="</span>",o+='<span class="separator"> </span>',o+='<span class="word">'):o+='<span class="letter" style="z-index:'+r+';">'+i[l]+"</span>",r--;o+="</span>";var s=" ";""!=n.textEllipsis&&(s=n.textEllipsis);for(var a="",l=0;l<s.length;l++)a+='<span class="letter" style="z-index:'+r+';">'+s[l]+"</span>",r--;var c=o+('<span class="word ellipsis">'+a+"</span>");t.html(c)})};y(".item");if(n.keepActive&&o.addClass("keep-active"),"number"==typeof n.fontSize)if(n.fontSize>=1&&n.fontSize<=7){n.fontSize=parseInt(n.fontSize);var I="font-size-"+n.fontSize.toString();o.find(".item>*:first-child").addClass(I)}else console.log("invalid font size: must be a integer from 1 to 7");else console.log("fontSize option must be a number");n.intro?(""!=n.introTitle?E=n.introTitle:void 0!==E&&""!=E&&E!=n.textEllipsis||(E="Scrollio"),""!=n.introDescription?w=n.introDescription:void 0!==w&&""!=w||(w="Scroll down to discover"),o.append('<div class="intro"><header><h1 class="font-size-7">'+E+'</h1><p class="description font-size-2">'+w+"</p></header></div>"),y(".intro header"),setTimeout(function(){-1==u&&o.children(".intro").addClass("active")},16)):o.children(".item").eq(0).addClass("active"),n.progressBar&&o.append('<div class="progress-bar"></div>'),o.addClass("initialized"),e(document).on("scroll",function(t){var i=e(window).scrollTop(),r=!0,a=i-h;a<0&&(r=!1),h=i,m=a,n.onScroll({index:l,relativeScroll:d,isScrollDown:r,progressBarCoef:v,itemProgressCoef:d/p}),Math.abs(a),function(){(c=e(window).scrollTop())>=f*p&&(c=f*p-1,e.Event("scrollEnd"),o.trigger({type:"scrollEnd"}));l=parseInt(c/p),d=c-p*l;var t=o.children(".item:eq("+l+")"),i=o.children(".item:not(:eq("+l+"))"),r=o.find(".item:eq("+l+") .letter").length,a=parseInt(p/r),h=parseInt(d/a);if(h!=u){if(u=h,t.hasClass("active")||(e.Event("itemChange"),e.Event("lastItem"),e.Event("firstItem"),o.trigger({type:"itemChange",targetIndex:l}),0==l&&o.trigger({type:"firstItem"}),l==f-1&&o.trigger({type:"lastItem"})),t.addClass("active"),e.Event("letterChange"),o.trigger({type:"letterChange"}),t.find(".letter:eq("+h+")").addClass("active current"),n.keepActive){for(m=0;m<h;m++)t.find(".letter:eq("+m+")").addClass("active").removeClass("current");for(var m=h+1;m<r;m++)t.find(".letter:eq("+m+")").removeClass("active current")}else t.find(".letter:not(:eq("+h+"))").removeClass("active current");i.removeClass("active"),n.intro&&c>0&&o.children(".intro").removeClass("active"),n.progressBar&&(g=(v=c/(f*p))*s,o.children(".progress-bar").css("width",g)),u=h}h==r-1&&(e.Event("itemEnd"),o.trigger({type:"itemEnd",index:l}))}()}),e(window).on("resize",function(e){s=window.innerWidth,a=window.innerHeight,r.height(f*p+window.innerHeight)}),o.on("itemChange",function(e){var t=e.targetIndex;n.onItemChange(t),C=!0}),o.on("firstItem",function(e){n.onFirstItem(e)}),o.on("lastItem",function(e){n.onLastItem(e)}),o.on("letterChange",function(e){n.onLetterChange(e)}),o.on("itemEnd",function(e){if(C){var t=e.index;n.onItemEnd(t);o.children(".item").eq(t);C=!1}}),o.on("scrollEnd",function(e){n.onScrollEnd(e)})}}}(jQuery);