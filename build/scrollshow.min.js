!function(e){e.fn.scrollshow=function(t){var n={id:"scrollshow",scrollRange:2e3,keepActive:!0,textEllipsis:"...",intro:!1,progressBar:!0,overlay:!0,onItemChange:function(e){},onLetterChange:function(e){},onScroll:function(e){},onItemEnd:function(e){},onFirstItem:function(e){},onLastItem:function(e){},onScrollEnd:function(e){}};if("string"==typeof t){if(0==t.indexOf("get:")){var i=t.replace("get:","");return"all"==i?n:void 0!==n[i]?n[i]:(console.log("not a valid scrollshow parameter"),!1)}return console.log("not a valid request"),!1}var r=e("#"+n.id);if(r.hasClass("initialized"))console.log("Scrollshow already initialized");else{var o=e("body"),a=window.innerWidth,s=window.innerHeight;if("object"==typeof t){Object.getOwnPropertyNames(t).forEach(function(e){n.hasOwnProperty(e)&&(n[e]=t[e])})}n.overlay&&r.append('<div class="overlay"></div>');var l=0,c=0,d=0,v=r.children(".item").length,h=n.scrollRange,f=0,g=0;o.height(v*h+s);var p=-1,m=!0,u=e('head meta[name="description"]').attr("content"),w=document.title,C=function(t){"string"==typeof t&&r.find(t).each(function(){var t=e(this).children().eq(0),i=t.text()+" "+n.textEllipsis,r="",o=1e3;r+='<span class="word">';for(var a=0;a<i.length;a++)" "==i[a]?(r+="</span>",r+='<span class="separator">'+i[a]+"</span>",r+='<span class="word">'):r+='<span class="letter" style="z-index:'+o+';">'+i[a]+"</span>",o--;r+="</span>",t.html(r)})};C(".item");n.intro?(void 0===u&&(u="Scroll down to discover"),void 0!==w&&""==w&&w==n.textEllipsis||(w="Scrollshow"),r.append('<div class="intro"><header><h1>'+w+'</h1><p class="description">'+u+"</p></header></div>"),C(".intro header"),setTimeout(function(){-1==p&&r.children(".intro").addClass("active")},16)):r.children(".item").eq(0).addClass("active"),n.progressBar&&r.append('<div class="progress-bar"></div>'),r.addClass("initialized"),e(document).on("scroll",function(t){var i=e(window).scrollTop(),o=!0,s=i-f;s<0&&(o=!1),f=i,g=s,n.onScroll(o),Math.abs(s),function(){(c=e(window).scrollTop())>=v*h&&(c=v*h-1,e.Event("scrollEnd"),r.trigger({type:"scrollEnd"}));l=parseInt(c/h),d=c-h*l;var t=r.children(".item:eq("+l+")"),i=r.children(".item:not(:eq("+l+"))"),o=r.find(".item:eq("+l+") .letter").length,s=parseInt(h/o),f=parseInt(d/s);if(f!=p){if(p=f,t.hasClass("active")||(e.Event("itemChange"),e.Event("lastItem"),e.Event("firstItem"),r.trigger({type:"itemChange",targetIndex:l}),0==l&&r.trigger({type:"firstItem"}),l==v-1&&r.trigger({type:"lastItem"})),t.addClass("active"),e.Event("letterChange"),r.trigger({type:"letterChange"}),t.find(".letter:eq("+f+")").addClass("active current"),n.keepActive){for(g=0;g<f;g++)t.find(".letter:eq("+g+")").addClass("active").removeClass("current");for(var g=f+1;g<o;g++)t.find(".letter:eq("+g+")").removeClass("active current")}else t.find(".letter:not(:eq("+f+"))").removeClass("active current");if(i.removeClass("active"),n.intro&&c>0&&r.children(".intro").removeClass("active"),n.progressBar){var m=c/(v*h)*a;r.children(".progress-bar").css("width",m)}p=f}f==o-1&&(e.Event("itemEnd"),r.trigger({type:"itemEnd",index:l}))}()}),e(window).on("resize",function(e){a=window.innerWidth,s=window.innerHeight,o.height(v*h+window.innerHeight)}),r.on("itemChange",function(e){var t=e.targetIndex;n.onItemChange(t),m=!0}),r.on("firstItem",function(e){n.onFirstItem(e)}),r.on("lastItem",function(e){n.onLastItem(e)}),r.on("letterChange",function(e){n.onLetterChange(e)}),r.on("itemEnd",function(e){if(m){var t=e.index;n.onItemEnd(t);r.children(".item").eq(t);m=!1}}),r.on("scrollEnd",function(e){n.onScrollEnd(e)})}}}(jQuery);