!function(e){e.fn.scrollshow=function(n){var t={id:"scrollshow",scrollRange:2e3,keepActive:!0,textEllipsis:"...",intro:!1,navigation:!1,progressBar:!0,overlay:!0,clickToGoNext:!1,onItemChange:function(e){},onLetterChange:function(e){},onScroll:function(e){},onItemEnd:function(e){},onFirstItem:function(e){},onLastItem:function(e){},onScrollEnd:function(e){}};if("object"==typeof n){Object.getOwnPropertyNames(n).forEach(function(e){t.hasOwnProperty(e)&&(t[e]=n[e])})}var r=e("body"),i=window.innerWidth,a=window.innerHeight,o=e("#"+t.id);t.overlay&&o.append('<div class="overlay"></div>');var s=0,l=0,c=0,d=o.children(".item").length,v=t.scrollRange,f=0,h=0;r.height(d*v+a);var p=-1,g=!0;if(t.navigation){o.append('<nav class="navigation"></nav>');for(var m=o.children(".navigation"),u=0;u<d;u++)m.append('<a href="#'+u.toString()+'"></a>'),0==u&&m.append('<span class="progress"></span>');var w=m.children("a:first-child"),C=(w.outerWidth(),w.outerHeight()),I=parseFloat(w.css("margin-bottom")),E=d*(C+I);m.find("a").on("click",function(n){n.preventDefault();var t=e(this).attr("href").replace("#",""),r=(t=parseInt(t))*v;e(document).scrollTop(r)})}var y=function(n){"string"==typeof n&&o.find(n).each(function(){var n=e(this).children().eq(0),r=n.text()+" "+t.textEllipsis,i="",a=1e3;i+='<span class="word">';for(var o=0;o<r.length;o++)" "==r[o]?(i+="</span>",i+='<span class="separator">'+r[o]+"</span>",i+='<span class="word">'):i+='<span class="letter" style="z-index:'+a+';">'+r[o]+"</span>",a--;i+="</span>",n.html(i)})};y(".item");t.intro?(o.append('<div class="intro"><header><h1>'+document.title+'</h1><p class="description">'+e('head meta[name="description"]').attr("content")+"</p></header></div>"),y(".intro header"),setTimeout(function(){-1==p&&o.children(".intro").addClass("active")},16)):o.children(".item").eq(0).addClass("active"),t.progressBar&&o.append('<div class="progress-bar"></div>'),t.clickToGoNext&&o.append('<div class="click-to-go-next"><p><a href="#next"><span>next</span></a></p></div>'),e(document).on("scroll",function(n){var a=e(window).scrollTop(),g=!0,u=a-f;u<0&&(g=!1),f=a,h=u,t.onScroll(g),Math.abs(u)>500&&(r.css("overflow","hidden"),alert("you are scrolling too fast, scroll slower"),r.css("overflow","auto")),function(){(l=e(window).scrollTop())>=d*v&&(l=d*v-1,e.Event("scrollEnd"),o.trigger({type:"scrollEnd"}));s=parseInt(l/v),c=l-v*s;var n=o.children(".item:eq("+s+")"),r=o.children(".item:not(:eq("+s+"))"),a=o.find(".item:eq("+s+") .letter").length,f=parseInt(v/a),h=parseInt(c/f);if(h!=p){if(p=h,n.hasClass("active")||(e.Event("itemChange"),e.Event("lastItem"),e.Event("firstItem"),o.trigger({type:"itemChange",targetIndex:s}),0==s&&o.trigger({type:"firstItem"}),s==d-1&&o.trigger({type:"lastItem"})),n.addClass("active"),e.Event("letterChange"),o.trigger({type:"letterChange"}),n.find(".letter:eq("+h+")").addClass("active current"),t.keepActive){for(g=0;g<h;g++)n.find(".letter:eq("+g+")").addClass("active").removeClass("current");for(var g=h+1;g<a;g++)n.find(".letter:eq("+g+")").removeClass("active current")}else n.find(".letter:not(:eq("+h+"))").removeClass("active current");if(r.removeClass("active"),t.navigation){for(var u=0;u<d;u++)u<=s?m.find('a[href="#'+u.toString()+'"]').addClass("active"):m.find('a[href="#'+u.toString()+'"]').removeClass("active");var w=l/(d*v)*E;s+1==d&&(w=E-I-C),m.children(".progress").height(w)}if(t.intro&&l>0&&o.children(".intro").removeClass("active"),t.progressBar){var y=l/(d*v)*i;o.children(".progress-bar").css("width",y)}p=h}h==a-1&&(e.Event("itemEnd"),o.trigger({type:"itemEnd",index:s}))}()}),e(window).on("resize",function(e){i=window.innerWidth,a=window.innerHeight,r.height(d*v+window.innerHeight)}),o.on("itemChange",function(e){var n=e.targetIndex;t.onItemChange(n),g=!0}),o.on("firstItem",function(e){t.onFirstItem(e)}),o.on("lastItem",function(e){t.onLastItem(e)}),o.on("letterChange",function(e){t.onLetterChange(e)}),o.on("itemEnd",function(n){if(g){var i=n.index;t.onItemEnd(i);var a=o.children(".item").eq(i);if(t.clickToGoNext&&!a.hasClass("done")&&h>0&&i!=d-1){var s=i+1;r.css("overflow","hidden"),e(".click-to-go-next").addClass("active").one("click",function(){a.addClass("done"),r.css("overflow","auto");var n=s*v;e(window).scrollTop(n),e(this).removeClass("active")})}g=!1}}),o.on("scrollEnd",function(e){t.onScrollEnd(e)})}}(jQuery);