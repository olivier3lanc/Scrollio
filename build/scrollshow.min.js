!function(e){e.fn.scrollshow=function(t){var n={id:"scrollshow",scrollRange:2e3,keepActive:!0,textEllipsis:"...",intro:!1,progressBar:!0,overlay:!0,onItemChange:function(e){},onLetterChange:function(e){},onScroll:function(e){},onItemEnd:function(e){},onFirstItem:function(e){},onLastItem:function(e){},onScrollEnd:function(e){}};if("string"==typeof t)return void 0!==n[t]&&n[t];var i=e("#"+n.id);if(i.hasClass("initialized"))console.log("Scrollshow already initialized");else{var r=e("body"),o=window.innerWidth,a=window.innerHeight;if("object"==typeof t){Object.getOwnPropertyNames(t).forEach(function(e){n.hasOwnProperty(e)&&(n[e]=t[e])})}n.overlay&&i.append('<div class="overlay"></div>');var s=0,l=0,c=0,d=i.children(".item").length,h=n.scrollRange,v=0,f=0;r.height(d*h+a);var p=-1,g=!0,m=e('head meta[name="description"]').attr("content"),u=document.title,w=function(t){"string"==typeof t&&i.find(t).each(function(){var t=e(this).children().eq(0),i=t.text()+" "+n.textEllipsis,r="",o=1e3;r+='<span class="word">';for(var a=0;a<i.length;a++)" "==i[a]?(r+="</span>",r+='<span class="separator">'+i[a]+"</span>",r+='<span class="word">'):r+='<span class="letter" style="z-index:'+o+';">'+i[a]+"</span>",o--;r+="</span>",t.html(r)})};w(".item");n.intro?(void 0===m&&(m="Scroll down to discover"),void 0!==u&&""==u&&u==n.textEllipsis||(u="Scrollshow"),i.append('<div class="intro"><header><h1>'+u+'</h1><p class="description">'+m+"</p></header></div>"),w(".intro header"),setTimeout(function(){-1==p&&i.children(".intro").addClass("active")},16)):i.children(".item").eq(0).addClass("active"),n.progressBar&&i.append('<div class="progress-bar"></div>'),i.addClass("initialized"),e(document).on("scroll",function(t){var r=e(window).scrollTop(),a=!0,g=r-v;g<0&&(a=!1),v=r,f=g,n.onScroll(a),Math.abs(g),function(){(l=e(window).scrollTop())>=d*h&&(l=d*h-1,e.Event("scrollEnd"),i.trigger({type:"scrollEnd"}));s=parseInt(l/h),c=l-h*s;var t=i.children(".item:eq("+s+")"),r=i.children(".item:not(:eq("+s+"))"),a=i.find(".item:eq("+s+") .letter").length,v=parseInt(h/a),f=parseInt(c/v);if(f!=p){if(p=f,t.hasClass("active")||(e.Event("itemChange"),e.Event("lastItem"),e.Event("firstItem"),i.trigger({type:"itemChange",targetIndex:s}),0==s&&i.trigger({type:"firstItem"}),s==d-1&&i.trigger({type:"lastItem"})),t.addClass("active"),e.Event("letterChange"),i.trigger({type:"letterChange"}),t.find(".letter:eq("+f+")").addClass("active current"),n.keepActive){for(g=0;g<f;g++)t.find(".letter:eq("+g+")").addClass("active").removeClass("current");for(var g=f+1;g<a;g++)t.find(".letter:eq("+g+")").removeClass("active current")}else t.find(".letter:not(:eq("+f+"))").removeClass("active current");if(r.removeClass("active"),n.intro&&l>0&&i.children(".intro").removeClass("active"),n.progressBar){var m=l/(d*h)*o;i.children(".progress-bar").css("width",m)}p=f}f==a-1&&(e.Event("itemEnd"),i.trigger({type:"itemEnd",index:s}))}()}),e(window).on("resize",function(e){o=window.innerWidth,a=window.innerHeight,r.height(d*h+window.innerHeight)}),i.on("itemChange",function(e){var t=e.targetIndex;n.onItemChange(t),g=!0}),i.on("firstItem",function(e){n.onFirstItem(e)}),i.on("lastItem",function(e){n.onLastItem(e)}),i.on("letterChange",function(e){n.onLetterChange(e)}),i.on("itemEnd",function(e){if(g){var t=e.index;n.onItemEnd(t);i.children(".item").eq(t);g=!1}}),i.on("scrollEnd",function(e){n.onScrollEnd(e)})}}}(jQuery);